"use strict";var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=_default,exports.CONSTANT=void 0;var _classCallCheck2=_interopRequireDefault(require("@babel/runtime/helpers/classCallCheck")),_createClass2=_interopRequireDefault(require("@babel/runtime/helpers/createClass")),_defineProperty2=_interopRequireDefault(require("@babel/runtime/helpers/defineProperty")),_uiUtil=require("@ctmobile/ui-util"),selectorPrefix="ct-scrolload-",ScrollLoad=function(){function r(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{distance:50};(0,_classCallCheck2.default)(this,r),this.el=e,this.scrollEl=this.el.querySelector(".".concat(selectorPrefix,"content")),this.loadEl=this.el.querySelector(".".concat(selectorPrefix,"load")),this.emptyEl=this.el.querySelector(".".concat(selectorPrefix,"empty")),this.errorEl=this.el.querySelector(".".concat(selectorPrefix,"error")),this.config=t,this.lock=!1,this.events=new _uiUtil.Events,this.onScroll=this.onScroll.bind(this),this.onEmptyClick=this.onEmptyClick.bind(this),this.onErrorClick=this.onErrorClick.bind(this),this.scrollEl.addEventListener("scroll",this.onScroll),this.emptyEl.addEventListener("click",this.onEmptyClick),this.errorEl.addEventListener("click",this.onErrorClick)}return(0,_createClass2.default)(r,[{key:"onScroll",value:function(){var t=this,e=this.scrollEl.scrollHeight-this.scrollEl.offsetHeight,l=this.scrollEl.scrollTop;if(this.events.hasType("scrollbottom")&&Math.abs(l-e)<=this.config.distance){if(this.lock)return;this.lock=!0,this.loadEl.style.display="flex",this.events.trigger("scrollbottom",{done:function(e){t.loadEl.style.display="none",e===r.EMPTY?t.emptyEl.style.display="block":e===r.ERROR&&(t.errorEl.style.display="block"),t.lock=!1}})}}},{key:"onEmptyClick",value:function(){this.events.hasType("emptyclick")&&this.events.trigger("emptyclick")}},{key:"onErrorClick",value:function(){this.events.hasType("errorclick")&&this.events.trigger("errorclick")}},{key:"on",value:function(e,t){this.events.on(e,t)}},{key:"off",value:function(e,t){e?t?this.events.remove(e,t):this.events.clear(e):this.events.clearAll()}},{key:"getLoadEl",value:function(){return this.loadEl}},{key:"getEmptyEl",value:function(){return this.emptyEl}},{key:"getErrorEl",value:function(){return this.errorEl}},{key:"hideAll",value:function(){this.loadEl.style.display="none",this.errorEl.style.display="none",this.emptyEl.style.display="none"}}]),r}();(0,_defineProperty2.default)(ScrollLoad,"EMPTY","empty"),(0,_defineProperty2.default)(ScrollLoad,"ERROR","error"),(0,_defineProperty2.default)(ScrollLoad,"NORMAL","normal");var CONSTANT={EMPTY:ScrollLoad.EMPTY,ERROR:ScrollLoad.ERROR,NORMAL:ScrollLoad.NORMAL};function _default(e,t){return new ScrollLoad(e,t)}exports.CONSTANT=CONSTANT;
//# sourceMappingURL=scrollload.js.map
