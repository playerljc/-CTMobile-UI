"use strict";var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _classCallCheck2=_interopRequireDefault(require("@babel/runtime/helpers/classCallCheck")),_createClass2=_interopRequireDefault(require("@babel/runtime/helpers/createClass")),_defineProperty2=_interopRequireDefault(require("@babel/runtime/helpers/defineProperty")),_lodash=_interopRequireDefault(require("lodash"));function ownKeys(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(t);e&&(l=l.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),i.push.apply(i,l)}return i}function _objectSpread(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?ownKeys(i,!0).forEach(function(e){(0,_defineProperty2.default)(t,e,i[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):ownKeys(i).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))})}return t}var template={toast:_lodash.default.template('<div class="ct-messdialog-toast-<%=position%>">\n          <div class="ct-messdialog-toast-wrap"><%=text%></div>\n       </div>'),alert:_lodash.default.template('<div class="ct-messdialog-dialog">\n         <div class="ct-messdialog-dialog-in">\n             <div class="ct-messdialog-dialog-in-inner">\n                 <div class="ct-messdialog-dialog-in-inner-title"><%=title%></div>\n                 <div class="ct-messdialog-dialog-in-inner-text <%=icon%>"><%=text%></div>\n             </div>\n             <div class="ct-messdialog-dialog-in-buttons">\n                 <span class="ct-messdialog-dialog-in-buttons-button">确定</span>\n             </div>\n         </div>\n      </div>'),confirm:_lodash.default.template('<div class="ct-messdialog-dialog">\n         <div class="ct-messdialog-dialog-in">\n             <div class="ct-messdialog-dialog-in-inner">\n                 <div class="ct-messdialog-dialog-in-inner-title"><%=title%></div>\n                 <div class="ct-messdialog-dialog-in-inner-text <%=icon%>"><%=text%></div>\n             </div>\n             <div class="ct-messdialog-dialog-in-buttons">\n                 <span class="ct-messdialog-dialog-in-buttons-button ok">确定</span>\n                 <span class="ct-messdialog-dialog-in-buttons-button cancel">取消</span>\n             </div>\n         </div>\n      </div>'),prompt:_lodash.default.template('<div class="ct-messdialog-dialog">\n         <div class="ct-messdialog-dialog-in">\n             <div class="ct-messdialog-dialog-in-inner">\n                 <div class="ct-messdialog-dialog-in-inner-title"><%=title%></div>\n                 <div class="ct-messdialog-dialog-in-inner-text"><%=text%></div>\n                 <div class="ct-messdialog-dialog-in-inner-input-field <%=icon%>">\n                     <input type="text" value="<%=defaultVal%>" class="text-input" placeholder="<%=placeholder%>">\n                 </div>\n             </div>\n             <div class="ct-messdialog-dialog-in-buttons">\n                 <span class="ct-messdialog-dialog-in-buttons-button ok">确定</span>\n                 <span class="ct-messdialog-dialog-in-buttons-button cancel">取消</span>\n             </div>\n         </div>\n      </div>'),promptmulit:_lodash.default.template('<div class="ct-messdialog-dialog">\n         <div class="ct-messdialog-dialog-in">\n             <div class="ct-messdialog-dialog-in-inner">\n                 <div class="ct-messdialog-dialog-in-inner-title"><%=title%></div>\n                 <div class="ct-messdialog-dialog-in-inner-text"><%=text%></div>\n                 <div class="ct-messdialog-dialog-in-inner-input-field <%=icon%>">\n                     <textarea value="<%=defaultVal%>" class="text-input" placeholder="<%=placeholder%>"></textarea>\n                 </div>\n             </div>\n             <div class="ct-messdialog-dialog-in-buttons">\n                 <span class="ct-messdialog-dialog-in-buttons-button ok">确定</span>\n                 <span class="ct-messdialog-dialog-in-buttons-button cancel">取消</span>\n             </div>\n         </div>\n      </div>'),custom:_lodash.default.template('<div class="ct-messdialog-dialog">\n         <div class="ct-messdialog-dialog-in">\n             <div class="ct-messdialog-dialog-in-inner">\n                 <div class="ct-messdialog-dialog-in-inner-title"><%=title%></div>\n                 <div class="ct-messdialog-dialog-in-inner-container"><%=html%></div>\n             </div>\n             <div class="ct-messdialog-dialog-in-buttons"></div>\n         </div>\n      </div>'),infinite:_lodash.default.template('<div class="ct-messdialog-dialog">\n         <div class="ct-messdialog-dialog-in">\n             <div class="ct-messdialog-dialog-in-inner">\n                 <div class="ct-messdialog-dialog-in-inner-title"><%=title%></div>\n                 <div class="ct-messdialog-dialog-in-inner-text"><%=text%></div>\n                 <div class="ct-messdialog-dialog-in-inner-input-field">\n                   <div class="progress-infinite"></div>\n                 </div>\n             </div>\n             <div class="ct-messdialog-dialog-in-buttons"></div>\n         </div>\n      </div>'),determined:_lodash.default.template('<div class="ct-messdialog-dialog">\n         <div class="ct-messdialog-dialog-in">\n             <div class="ct-messdialog-dialog-in-inner">\n                 <div class="ct-messdialog-dialog-in-inner-title"><%=title%></div>\n                 <div class="ct-messdialog-dialog-in-inner-text"><%=text%></div>\n                 <div class="ct-messdialog-dialog-in-inner-text ct-messdialog-dialog-in-inner-progress-text "><%=format%></div>\n                 <div class="ct-messdialog-dialog-in-inner-input-field">\n                   <div class="progress-determined">\n                    <div class="progress-bar"></div>\n                   </div>\n                 </div>\n             </div>\n             <div class="ct-messdialog-dialog-in-buttons"></div>\n         </div>\n      </div>'),loading:_lodash.default.template('<div class="ct-messdialog-loading">\n          \x3c!-- nonetwork --\x3e\n          <div class="ct-messdialog-loading-nonetwork">\n              <div class="ct-messdialog-loading-nonetwork-header">\n                <a data-role="none" class="icon-back-purple"></a>\n              </div>\n              <div class="ct-messdialog-loading-nonetwork-content">\n                 <div class="ct-messdialog-loading-nonetwork-content-logo"></div>\n                 <div class="ct-messdialog-loading-nonetwork-content-tip"></div>\n                 <div class="ct-messdialog-loading-nonetwork-content-setting">设置</div>\n              </div>\n          </div>\n          \x3c!-- fail --\x3e\n          <div class="ct-messdialog-loading-fail">\n              <div class="ct-messdialog-loading-fail-header">\n                <a data-role="none" class="icon-back-purple"></a>\n              </div>\n              <div class="ct-messdialog-loading-fail-content">\n                 <div class="ct-messdialog-loading-fail-content-logo"></div>\n                 <div class="ct-messdialog-loading-fail-content-tip"></div>\n                 <div class="ct-messdialog-loading-fail-content-refresh">重试</div>\n              </div>\n          </div>\n          \x3c!-- loading --\x3e\n         <div class="ct-messdialog-loading-loading">\n             <div class="la-ball-clip-rotate la-dark" style="color: #3e98f0;">\n                 <div></div>\n             </div>\n             <div class="ct-messdialog-loading-loading-tip">加载中...</div>\n         </div>\n          \x3c!-- empty --\x3e\n          <div class="ct-messdialog-loading-empty">\n              <div class="ct-messdialog-loading-empty-logo"></div>\n              <div class="ct-messdialog-loading-empty-tip"></div>\n              <div class="ct-messdialog-loading-empty-refresh">重新加载</div>\n          </div>\n          \x3c!-- submit --\x3e\n          <div class="ct-messdialog-loading-submit">\n              <div class="ct-messdialog-loading-submit-inner">\n                  <div class="la-line-spin-clockwise-fade-rotating la-dark">\n                      <div></div>\n                      <div></div>\n                      <div></div>\n                      <div></div>\n                      <div></div>\n                      <div></div>\n                      <div></div>\n                      <div></div>\n                  </div>\n                  <span class="ct-messdialog-loading-submit-inner-tip">玩命处理中，请稍后...</span>\n              </div>\n          </div>\n      </div>')};function show(e,t){var i=setTimeout(function(){clearTimeout(i),e.classList.add("ct-messdialog-dialog-in-show"),t.classList.add("ct-messdialog-dialog-in-show")},100)}function _close(t,i,l,n){i.addEventListener("transitionend",function e(){i.removeEventListener("transitionend",e),l.classList.remove("ct-messdialog-dialog-in-hide"),i.classList.remove("ct-messdialog-dialog-in-hide"),l.style.display="none",t.removeChild(l),l=i=null,n&&n()}),i.classList.remove("ct-messdialog-dialog-in-show"),l.classList.remove("ct-messdialog-dialog-in-show"),i.classList.add("ct-messdialog-dialog-in-hide"),l.classList.add("ct-messdialog-dialog-in-hide")}function createElement(e){var t=e(1<arguments.length&&void 0!==arguments[1]?arguments[1]:{}),i=document.createElement("div");return i.innerHTML=t,i.firstElementChild}function alertCreate(e){var t=e.parent,i=e.title,l=e.text,n=e.icon,a=e.callback,s=createElement(template.alert,{title:i,text:l,icon:n});s.querySelector(".ct-messdialog-dialog-in-buttons-button").addEventListener("click",function(){_close(t,o,s,a)}),t.appendChild(s);var o=s.querySelector(".ct-messdialog-dialog-in");return s.style.display="flex",show(s,o),{close:function(){_close(t,o,s,a)}}}function confirmCreate(e){var t=e.parent,i=e.title,l=e.text,n=e.icon,a=e.callback,s=createElement(template.confirm,{title:i,text:l,icon:n});s.querySelector(".ok").addEventListener("click",function(e){e.stopPropagation(),e.preventDefault(),_close(t,o,s,function(){a&&a(0)})}),s.querySelector(".cancel").addEventListener("click",function(e){e.stopPropagation(),e.preventDefault(),_close(t,o,s,function(){a&&a(1)})}),t.appendChild(s);var o=s.querySelector(".ct-messdialog-dialog-in");s.style.display="flex",show(s,o)}function promptCreate(e){var t=e.type,i=e.parent,l=e.selector,n=e.title,a=e.text,s=e.icon,o=e.defaultVal,d=e.placeholder,c=e.callback,r=createElement(template[t],{title:n,text:a,icon:s,defaultVal:o,placeholder:d});r.querySelector(".ok").addEventListener("click",function(){_close(i,g,r,function(){c&&c(0,u.value)})}),r.querySelector(".cancel").addEventListener("click",function(){_close(i,g,r,function(){c&&c(1,u.value)})}),i.appendChild(r);var g=r.querySelector(".ct-messdialog-dialog-in"),u=g.querySelector(l);r.style.display="flex",show(r,g)}function customdialogCreate(e){var t=e.parent,i=e.title,l=e.html,n=e.buttons,a=e.rendercallback,s=createElement(template.custom,{title:i,html:l}),o=s.querySelector(".ct-messdialog-dialog-in-inner-container"),d=s.querySelector(".ct-messdialog-dialog-in-buttons"),c=d.children;d.addEventListener("click",function(e){var t=e.target,i=Array.prototype.indexOf.call(c,t);n[i]&&n[i].handler&&n[i].handler()});for(var r=document.createDocumentFragment(),g=0;n&&g<n.length;g++){var u=n[g];r.appendChild(createElement(_lodash.default.template("<span class='ct-messdialog-dialog-in-buttons-button'>".concat(u.text,"</span>"))))}d.appendChild(r),t.appendChild(s),a&&a(o);var p=s.querySelector(".ct-messdialog-dialog-in");return s.style.display="flex",show(s,p),{el:s,close:function(){_close(t,p,s)}}}function infiniteProgressDialogCreate(e){var t=e.parent,i=e.title,l=e.text,n=void 0===l?"":l,a=e.buttons,s=e.rendercallback,o=createElement(template.infinite,{title:i,text:n}),d=o.querySelector(".ct-messdialog-dialog-in-inner-container"),c=o.querySelector(".ct-messdialog-dialog-in-buttons"),r=c.children;c.addEventListener("click",function(e){var t=e.target,i=Array.prototype.indexOf.call(r,t);a[i]&&a[i].handler&&a[i].handler()});for(var g=document.createDocumentFragment(),u=0;a&&u<a.length;u++){var p=a[u];g.appendChild(createElement(_lodash.default.template("<span class='ct-messdialog-dialog-in-buttons-button'>".concat(p.text,"</span>"))))}c.appendChild(g),t.appendChild(o),s&&s(d);var v=o.querySelector(".ct-messdialog-dialog-in");return o.style.display="flex",show(o,v),{el:o,close:function(){_close(t,v,o)}}}function determinedProgressDialogCreate(e){var t=e.parent,i=e.title,l=void 0===i?"":i,n=e.text,a=void 0===n?"":n,s=e.format,o=void 0===s?"<%=value%> of <%=total%>":s,d=e.total,c=void 0===d?100:d,r=e.buttons,g=void 0===r?[]:r,u=e.rendercallback,p=e.completecallback,v=e.changecallback,m=template.determined({title:l,text:a,format:o}),y=createElement(_lodash.default.template(m),{value:0,total:c}),f=y.querySelector(".ct-messdialog-dialog-in-inner-container"),h=y.querySelector(".ct-messdialog-dialog-in-buttons"),b=y.querySelector(".progress-bar"),x=y.querySelector(".ct-messdialog-dialog-in-inner-progress-text"),k=h.children;h.addEventListener("click",function(e){var t=e.target,i=Array.prototype.indexOf.call(k,t);g[i]&&g[i].handler&&g[i].handler()});for(var w=document.createDocumentFragment(),S=0;g&&S<g.length;S++){var q=g[S];w.appendChild(createElement(_lodash.default.template("<span class='ct-messdialog-dialog-in-buttons-button'>".concat(q.text,"</span>"))))}h.appendChild(w),t.appendChild(y),u&&u(f);var C=y.querySelector(".ct-messdialog-dialog-in");return y.style.display="flex",show(y,C),{el:y,close:function(){_close(t,C,y)},setValue:function(e){if(!e)return!1;if("string"==typeof e&&(e=parseFloat(e)),isNaN(e))return!1;e<0&&(e=0),c<e&&(e=c),b.style.width="".concat(Math.floor(e/c*100),"%");var t=_lodash.default.template(o)({value:e,total:c});x.innerText=t,e!==c?v&&v(e):p&&p()}}}var Toast=function(){function o(e){(0,_classCallCheck2.default)(this,o),this.config=e,this.init()}return(0,_createClass2.default)(o,[{key:"init",value:function(){var e=this.config,t=e.parent,i=e.text,l=void 0===i?"":i,n=e.position,a=e.duration;a="long"===a?2e3:1e3;var s=createElement(template.toast,{text:l,position:n});o.toastQueue.push({parent:t,toast:s,duration:a}),o.toastKey||(o.toastKey=!0,this.showToast())}},{key:"showToast",value:function(){var t=this;if(0!==o.toastQueue.length){var i=o.toastQueue.shift(),e=i,l=e.duration,n=e.parent,a=(i=i.toast).querySelector(".ct-messdialog-toast-wrap");n.appendChild(i),i.style.display="flex",setTimeout(function(){a.classList.add("ct-messdialog-toast-show"),setTimeout(function(){a.addEventListener("transitionend",function e(){a.removeEventListener("transitionend",e),i.style.display="none",n.removeChild(i),t.showToast()}),a.classList.remove("ct-messdialog-toast-show")},l)},100)}else o.toastKey=!1}}]),o}();(0,_defineProperty2.default)(Toast,"toastQueue",[]),(0,_defineProperty2.default)(Toast,"toastKey",!1);var makeTextCreate=function(e){new Toast(e)};function makeLoadingCreate(e){var t=e.parent,i=e.refreshCallback,l=e.boundingCallback,n=e.isShowHeader,a=createElement(template.loading),s=a.querySelector(".ct-messdialog-loading-loading"),o=a.querySelector(".ct-messdialog-loading-fail"),d=a.querySelector(".ct-messdialog-loading-nonetwork"),c=a.querySelector(".ct-messdialog-loading-empty"),r=a.querySelector(".ct-messdialog-loading-submit"),g=[a.querySelector(".ct-messdialog-loading-nonetwork-content-setting"),a.querySelector(".ct-messdialog-loading-fail-content-refresh"),a.querySelector(".ct-messdialog-loading-empty-refresh")];if(g&&0!==g.length)for(var u=0,p=g.length;u<p;u++)g[u].addEventListener("click",function(){i&&i()});return a.querySelector(".ct-messdialog-loading-nonetwork-content-setting").addEventListener("click",function(){}),t.appendChild(a),{setLoadingTip:function(e){s.querySelector(".ct-messdialog-loading-loading-tip").innerText=e},setNoNetWorkTip:function(e){d.querySelector(".ct-messdialog-loading-nonetwork-content-tip").innerText=e},setFailTip:function(e){o.querySelector(".ct-messdialog-loading-fail-content-tip").innerText=e},setEmptyTip:function(e){c.querySelector(".ct-messdialog-loading-empty-tip").innerText=e},setSubmitTip:function(e){r.querySelector(".ct-messdialog-loading-submit-inner-tip").innerText=e},showLoading:function(){if(t.style.overflowY="hidden",s.style.display="flex",d.style.display=o.style.display=c.style.display=r.style.display="none",l){var e=l();a.style.top=e.top,a.style.bottom=e.bottom}a.style.display="flex"},showEmpty:function(){if(t.style.overflowY="hidden",c.style.display="flex",d.style.display=s.style.display=o.style.display=r.style.display="none",l){var e=l();a.style.top=e.top,a.style.bottom=e.bottom}a.style.display="flex"},showNoNetWork:function(){t.style.overflowY="hidden",d.style.display="block",s.style.display=o.style.display=c.style.display=r.style.display="none",a.style.top="0",a.style.bottom="0",n?n()?d.querySelector(".ct-messdialog-loading-nonetwork-header").style.display="block":d.querySelector(".ct-messdialog-loading-nonetwork-header").style.display="none":d.querySelector(".ct-messdialog-loading-nonetwork-header").style.display="block",a.style.display="block"},showFail:function(){t.style.overflowY="hidden",o.style.display="block",d.style.display=s.style.display=c.style.display=r.style.display="none",a.style.top="0",a.style.bottom="0",n?n()?(o.querySelector(".ct-messdialog-loading-fail-content").style.top="3rem",o.querySelector(".ct-messdialog-loading-fail-header").style.display="flex"):(o.querySelector(".ct-messdialog-loading-fail-content").style.top="0",o.querySelector(".ct-messdialog-loading-fail-header").style.display="none"):(o.querySelector(".ct-messdialog-loading-fail-content").style.top="3rem",o.querySelector(".ct-messdialog-loading-fail-header").style.display="flex"),a.style.display="block"},showSubmit:function(){t.style.overflowY="hidden",r.style.display="flex",d.style.display=s.style.display=o.style.display=c.style.display="none",a.style.top="0",a.style.bottom="0",a.style.display="flex"},hide:function(){t.style.overflowY="auto",a.style.display="none",d.style.display=c.style.display=s.style.display=o.style.display=r.style.display="none"},close:function(){t.style.overflowY="hidden",t.removeChild(a),a=null},isShowLoading:function(){return"none"!==s.style.display},isShowNoNetWork:function(){return"none"!==d.style.display},isShowFail:function(){return"none"!==o.style.display},isShowEmpty:function(){return"none"!==c.style.display},isShowSubmit:function(){return"none"!==r.style.display},getParent:function(){return t}}}var MessageDialog=function(){function e(){(0,_classCallCheck2.default)(this,e)}return(0,_createClass2.default)(e,null,[{key:"alert",value:function(e){return alertCreate(e)}},{key:"confirm",value:function(e){confirmCreate(e)}},{key:"prompt",value:function(e){promptCreate(_objectSpread({type:"prompt",selector:"input"},e))}},{key:"promptmulit",value:function(e){promptCreate(_objectSpread({type:"promptmulit",selector:"textarea"},e))}},{key:"customDialog",value:function(e){return customdialogCreate(e)}},{key:"infiniteProgressDialog",value:function(e){return infiniteProgressDialogCreate(e)}},{key:"determinedProgressDialog",value:function(e){return determinedProgressDialogCreate(e)}},{key:"makeText",value:function(e){makeTextCreate(e)}},{key:"makeLoading",value:function(e){return makeLoadingCreate(e)}}]),e}(),_default=MessageDialog;exports.default=_default;
//# sourceMappingURL=messagedialog.js.map
