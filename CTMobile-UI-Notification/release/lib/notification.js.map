{"version":3,"sources":["notification.js"],"names":["_interopRequireDefault","require","Object","defineProperty","exports","value","_default","_classCallCheck2","_createClass2","_uiUtil","defaultConfig","style","type","className","init","this","config","assign","el","classList","remove","concat","join","add","initEvents","self","listeners","_this$config$listener","keys","i","length","p","events","on","notificationEl","addEventListener","e","target","contains","closeNotification","call","parentNode","dataset","id","key","n","notifications","trigger","apply","transitionendAction","removeEventListener","removeChild","overflow","querySelector","opacity","height","buildStandard","_ref","_ref$headerLabel","headerLabel","_ref$headerIcon","headerIcon","_ref$title","title","_ref$text","text","_ref$icon","icon","_ref$closed","closed","_ref$datetime","datetime","uuid","Dom6","createElement","build","buildCustom","_ref2","_ref2$html","html","_ref2$closed","appendChild","targetHeight","clientHeight","setTimeout","Notification","children","Events","handler","clear","clearAll"],"mappings":"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","file":"notification.js","sourcesContent":["\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports[\"default\"] = _default;\n\nvar _classCallCheck2 = _interopRequireDefault(require(\"@babel/runtime/helpers/classCallCheck\"));\n\nvar _createClass2 = _interopRequireDefault(require(\"@babel/runtime/helpers/createClass\"));\n\nvar _uiUtil = require(\"@ctmobile/ui-util\");\n\nvar defaultConfig = {\n  style: 'material',\n  type: 'top'\n};\nvar className = ['ct', 'notification'];\n/**\r\n * init\r\n * @access private\r\n */\n\nfunction init() {\n  this.config = Object.assign({}, defaultConfig, this.config);\n  this.el.classList.remove([].concat(className).concat([this.config.type === 'top' ? 'bottom' : 'top', this.config.style]).join('-'));\n  this.el.classList.add([].concat(className).concat([this.config.type, this.config.style]).join('-'));\n}\n/**\r\n * initEvents\r\n * @access private\r\n */\n\n\nfunction initEvents() {\n  var self = this;\n\n  if (this.config.listeners) {\n    var _this$config$listener = this.config.listeners,\n        listeners = _this$config$listener === void 0 ? {} : _this$config$listener;\n    var keys = Object.keys(listeners);\n\n    for (var i = 0; i < keys.length; i += 1) {\n      var p = keys[i];\n      this.events.on(p, listeners[p]);\n    }\n  }\n\n  this.notificationEl.addEventListener('click', function (e) {\n    if (e.target.classList.contains('closeBtn')) {\n      closeNotification.call(self, e.target.parentNode.dataset.id);\n    }\n  });\n}\n/**\r\n * 点击删除通知\r\n * closeNotification\r\n * @param {string} id\r\n * @access private\r\n */\n\n\nfunction closeNotification(id) {\n  if (this.key) return;\n  this.key = true;\n  var self = this;\n  var n = this.notifications[id];\n\n  function transitionendAction() {\n    n.removeEventListener('transitionend', transitionendAction);\n    self.notificationEl.removeChild(n);\n    self.key = false; // closeAfter\n\n    self.events.trigger('closeAfter', n);\n  } // closeBefore\n\n\n  this.events.trigger.apply(self, ['closeBefore', n]);\n  n.addEventListener('transitionend', transitionendAction);\n  n.style.overflow = 'hidden';\n  n.querySelector('.info').style.opacity = '0';\n  n.style.height = '0';\n}\n/**\r\n * buildStandard\r\n * @param config {\r\n *  headerLabel: string,\r\n *  headerIcon: string,\r\n *  title:string,\r\n *  text:string,\r\n *  icon:string,\r\n *  closed:boolean,\r\n *  datetime:string\r\n * }\r\n * @return {string} id\r\n * @access private\r\n */\n\n\nfunction buildStandard(_ref) {\n  var _ref$headerLabel = _ref.headerLabel,\n      headerLabel = _ref$headerLabel === void 0 ? '' : _ref$headerLabel,\n      _ref$headerIcon = _ref.headerIcon,\n      headerIcon = _ref$headerIcon === void 0 ? '' : _ref$headerIcon,\n      _ref$title = _ref.title,\n      title = _ref$title === void 0 ? '' : _ref$title,\n      _ref$text = _ref.text,\n      text = _ref$text === void 0 ? '' : _ref$text,\n      _ref$icon = _ref.icon,\n      icon = _ref$icon === void 0 ? '' : _ref$icon,\n      _ref$closed = _ref.closed,\n      closed = _ref$closed === void 0 ? true : _ref$closed,\n      _ref$datetime = _ref.datetime,\n      datetime = _ref$datetime === void 0 ? '' : _ref$datetime;\n  var self = this;\n  var id = (0, _uiUtil.uuid)(6);\n\n  var n = _uiUtil.Dom6.createElement(\"<li data-id=\\\"\".concat(id, \"\\\">\\n       <div class=\\\"info\\\">\\n          <div class=\\\"ct-notification-standard-header\\\">\\n             <div class=\\\"ct-notification-standard-header-icon\\\">\").concat(headerIcon ? \"<img src=\\\"\".concat(headerIcon, \"\\\">\") : '', \"</div>\\n             <div class=\\\"ct-notification-standard-header-label\\\">\").concat(headerLabel || '', \"</div>\\n          </div>\\n          <div class=\\\"ct-notification-standard-content\\\">\\n             <div class=\\\"ct-notification-standard-content-media-l\\\">\").concat(icon ? \"<img src=\\\"\".concat(icon, \"\\\">\") : '', \"</div>\\n             <div class=\\\"ct-notification-standard-content-row\\\">\\n               <div class=\\\"ct-notification-standard-content-row-title\\\">\").concat(title || '', \"</div>\\n               <div class=\\\"ct-notification-standard-content-row-text\\\">\").concat(text || '', \"</div>\\n             </div>\\n             <div class=\\\"ct-notification-standard-content-media-r\\\">\").concat(datetime || '', \"</div>\\n          </div>\\n       </div>\").concat(closed ? '<span class=\"closeBtn\"></span>' : '', \"\\n    </li>\"));\n\n  return build.call(self, id, n);\n}\n/**\r\n * buildCustom\r\n * @param config\r\n * @return {string} id\r\n */\n\n\nfunction buildCustom(_ref2) {\n  var _ref2$html = _ref2.html,\n      html = _ref2$html === void 0 ? '' : _ref2$html,\n      _ref2$closed = _ref2.closed,\n      closed = _ref2$closed === void 0 ? true : _ref2$closed;\n  var id = (0, _uiUtil.uuid)(6);\n\n  var n = _uiUtil.Dom6.createElement(\"<li data-id=\\\"\".concat(id, \"\\\">\\n       <div class=\\\"info\\\">\").concat(html, \"</div>\").concat(closed ? '<span class=\"closeBtn\"></span>' : '', \"\\n    </li>\"));\n\n  return build.call(this, id, n);\n}\n/**\r\n * build\r\n * 创建一个notification\r\n * @param {string} id\r\n * @param {HtmlElement} n\r\n * @access private\r\n * @return {string} id\r\n */\n\n\nfunction build(id, n) {\n  var self = this;\n  this.notifications[id] = n;\n  this.notificationEl.appendChild(n); // oncreate\n\n  this.events.trigger('create', n);\n  n.style.height = 'auto';\n  var targetHeight = n.clientHeight\n  /* window.getComputedStyle(n).height */\n  ; // 会有最小高度的限制\n\n  if (self.config.style === 'material') {\n    if (targetHeight < 40) {\n      targetHeight = 40;\n    }\n  } else if (self.config.style === 'ios') {\n    if (targetHeight < 70) {\n      targetHeight = 70;\n    }\n  }\n\n  n.style.height = '0';\n  setTimeout(function () {\n    n.style.height = \"\".concat(targetHeight, \"px\");\n    n.querySelector('.info').style.opacity = '1';\n    self.events.trigger('show', n);\n  }, 100);\n  return id;\n}\n/**\r\n * Notification\r\n * @class Notification\r\n * @classdesc Notification\r\n */\n\n\nvar Notification =\n/*#__PURE__*/\nfunction () {\n  /**\r\n   * constructor\r\n   * @param {HtmlElement} el\r\n   * @param {object} config\r\n   * {\r\n   *     html: html[html字符串],\r\n   *     style: 风格 [ios | material],\r\n   *     type : 类型 [top | bottom],\r\n   *     listeners:{\r\n   *          create:\r\n   *          show:\r\n   *          close:\r\n   *     }\r\n   * }\r\n   */\n  function Notification(el, config) {\n    (0, _classCallCheck2[\"default\"])(this, Notification);\n    this.config = config;\n    this.el = el; // 存放所有的notification\n\n    this.notifications = {};\n    this.key = false;\n    this.notificationEl = this.el.children[0];\n    this.events = new _uiUtil.Events();\n    init.call(this);\n    initEvents.call(this);\n  }\n  /**\r\n   * show\r\n   * @param {Object} config\r\n   * @return {string} id\r\n   */\n\n\n  (0, _createClass2[\"default\"])(Notification, [{\n    key: \"show\",\n    value: function show(config) {\n      return buildCustom.call(this, config);\n    }\n    /**\r\n     * showStandard\r\n     * @param {Object} config\r\n     * @return {string} id\r\n     */\n\n  }, {\n    key: \"showStandard\",\n    value: function showStandard(config) {\n      return buildStandard.call(this, config);\n    }\n    /**\r\n     * close\r\n     * @param {string} id\r\n     */\n\n  }, {\n    key: \"close\",\n    value: function close(id) {\n      closeNotification.call(this, id);\n    }\n    /**\r\n     * on 注册事件\r\n     * @param {string} type\r\n     * @param {Function} handler\r\n     */\n\n  }, {\n    key: \"on\",\n    value: function on(type, handler) {\n      this.events.on(type, handler);\n    }\n    /**\r\n     * 删除指定type下的事件或清除所有\r\n     * @param {string} type\r\n     * @param {Function} handler\r\n     */\n\n  }, {\n    key: \"off\",\n    value: function off(type, handler) {\n      if (type) {\n        if (handler) {\n          this.events.remove(type, handler);\n        } else {\n          this.events.clear(type);\n        }\n      } else {\n        this.events.clearAll();\n      }\n    }\n  }]);\n  return Notification;\n}();\n/**\r\n * Notification\r\n * @param {HtmlElement} el\r\n * @param {object} config\r\n * @return {Notification}\r\n */\n\n\nfunction _default(el, config) {\n  return new Notification(el, config);\n}"]}