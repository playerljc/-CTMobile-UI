"use strict";var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=_default;var _classCallCheck2=_interopRequireDefault(require("@babel/runtime/helpers/classCallCheck")),_createClass2=_interopRequireDefault(require("@babel/runtime/helpers/createClass")),_jquery=_interopRequireDefault(require("jquery")),_iscrollProbe=_interopRequireDefault(require("iscroll/build/iscroll-probe")),_uiStickuplayout=_interopRequireDefault(require("@ctmobile/ui-stickuplayout")),SELECTORS={column:".ct-cascadecompared-indicator > .ct-cascadecompared-autoWrap > .ct-cascadecompared-item > .ct-cascadecompared-cell",indicatorFixedWrap:".ct-cascadecompared-indicator > .ct-cascadecompared-fixedWrap",indicatorAutoWrap:".ct-cascadecompared-indicator > .ct-cascadecompared-autoWrap",masterFixedWrap:".ct-cascadecompared-master > .ct-cascadecompared-master-inner > .ct-stickuplayout-inner > .ct-stickuplayout-item > .ct-stickuplayout-item-content > .ct-cascadecompared-fixedWrap",masterAutoWrap:".ct-cascadecompared-master > .ct-cascadecompared-master-inner > .ct-stickuplayout-inner > .ct-stickuplayout-item > .ct-stickuplayout-item-content > .ct-cascadecompared-autoWrap",indicatorFirstCell:".ct-cascadecompared-indicator > .ct-cascadecompared-fixedWrap > .ct-cascadecompared-item > .ct-cascadecompared-cell",indicatorCellOfType:function(t){return".ct-cascadecompared-indicator > .ct-cascadecompared-autoWrap > .ct-cascadecompared-item > .ct-cascadecompared-cell:nth-of-type(".concat(t,")")},masterCellOfType:function(t){return".ct-cascadecompared-master > .ct-cascadecompared-master-inner > .ct-stickuplayout-inner > .ct-stickuplayout-item > .ct-stickuplayout-item-content > .ct-cascadecompared-autoWrap .ct-cascadecompared-item > .ct-cascadecompared-cell:nth-of-type(".concat(t,")")},row:".ct-cascadecompared-master > .ct-cascadecompared-master-inner > .ct-stickuplayout-inner > .ct-stickuplayout-item > .ct-stickuplayout-item-content > .ct-cascadecompared-fixedWrap > .ct-cascadecompared-item",indicator:"ct-cascadecompared-indicator",masterFixedWrapRow:".ct-cascadecompared-master > .ct-cascadecompared-master-inner > .ct-stickuplayout-inner > .ct-stickuplayout-item > .ct-stickuplayout-item-content > .ct-cascadecompared-fixedWrap > .ct-cascadecompared-item",masterAutoWrapRow:".ct-cascadecompared-master > .ct-cascadecompared-master-inner > .ct-stickuplayout-inner > .ct-stickuplayout-item > .ct-stickuplayout-item-content > .ct-cascadecompared-autoWrap > .ct-cascadecompared-autoInner > .ct-cascadecompared-item"};function isAuto(t){return!t||"undefined"===t||null===t||""===t||"auto"===t}function initScroll(){var e=this;this.wrapEls=this.el.querySelectorAll(".ct-cascadecompared-autoWrap");for(var t=0;t<this.scrolls.length;t++)this.scrolls[t].destroy();this.scrolls=[];for(var c=0;c<this.wrapEls.length;c++){var a=new _iscrollProbe.default(this.wrapEls[c],{probeType:3,eventPassthrough:!0,scrollX:!0,scrollY:!1,preventDefault:!1});this.scrolls.push(a),a.on("scroll",function(){for(var t=0;t<e.scrolls.length;t++)e.scrolls[t]!==this&&e.scrolls[t].scrollTo(this.x,this.y)}),a.on("scrollEnd",function(){e.stickup.events.scrollEnd&&e.stickup.events.scrollEnd()})}}function initial(){this.scrolls=[],initDimension.call(this),this.stickup=(0,_uiStickuplayout.default)(this.el),initScroll.call(this)}function initDimension(){for(var t=this.config,e=t.columnsWidth,c=void 0===e?[]:e,a=t.rowsHeight,r=void 0===a?[]:a,i=this.el.querySelectorAll(SELECTORS.column).length,s=0;s<i+1;s++){var o=void 0;0===s?(isAuto(c[0])||(o=c[0]),this.$el.find(SELECTORS.indicatorFixedWrap).css("width","".concat(parseInt(o),"px")),this.$el.find(SELECTORS.indicatorAutoWrap).css("margin-left","".concat(parseInt(o),"px")),this.$el.find(SELECTORS.masterFixedWrap).css("width","".concat(parseInt(o),"px")),this.$el.find(SELECTORS.masterAutoWrap).css("margin-left","".concat(parseInt(o),"px"))):(isAuto(c[s])||(o=c[s]),this.$el.find(SELECTORS.indicatorCellOfType(s)).css("width","".concat(parseInt(o),"px")),this.$el.find(SELECTORS.masterCellOfType(s)).css("width","".concat(parseInt(o),"px")))}for(var l=this.$el.find(SELECTORS.row).length,n=0;n<l+1;n++){var d=void 0;0===n?(isAuto(r[0])||(d=r[0]),this.$el.find(SELECTORS.indicator).css("height","".concat(parseInt(d),"px"))):(isAuto(r[n])||(d=r[n]),this.$el.find(SELECTORS.masterFixedWrapRow).eq(n-1).css("height","".concat(d,"px")),this.$el.find(SELECTORS.masterAutoWrapRow).eq(n-1).css("height","".concat(d,"px")))}}var CascadeCompared=function(){function c(t,e){(0,_classCallCheck2.default)(this,c),this.el=t,this.$el=(0,_jquery.default)(this.el),this.config=JSON.parse(JSON.stringify(e)),initial.call(this)}return(0,_createClass2.default)(c,[{key:"scrollToByIndex",value:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:300;this.stickup.scrollToByIndex(t,e)}},{key:"scrollToByHeaderEl",value:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:300;this.stickup.scrollToByHeaderEl(t,e)}},{key:"scrollToByColumn",value:function(t){var e=this.scrolls[0];e.scrollToElement((0,_jquery.default)(e.wrapper).find(".ct-cascadecompared-item .ct-cascadecompared-cell:nth-of-type(".concat(t,")"))[0])}},{key:"refresh",value:function(){initDimension.call(this),initScroll.call(this),this.stickup.refresh()}},{key:"on",value:function(t,e){this.stickup.on(t,e)}}]),c}();function _default(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return new CascadeCompared(t,e)}